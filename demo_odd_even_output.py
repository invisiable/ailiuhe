"""
æ¼”ç¤ºå¥‡å¶é¢„æµ‹æ¨¡å‹åœ¨æ§åˆ¶å°çš„è¾“å‡ºæ ¼å¼
"""

from odd_even_predictor import OddEvenPredictor


def demo_odd_even_output():
    """æ¼”ç¤ºå¥‡å¶é¢„æµ‹çš„è¾“å‡ºæ ¼å¼"""
    
    print("="*70)
    print("ğŸ² å¥‡å¶æ€§é¢„æµ‹æ¨¡å‹ - è¾“å‡ºæ ¼å¼æ¼”ç¤º")
    print("="*70)
    
    predictor = OddEvenPredictor()
    
    # 1. æ˜¾ç¤ºå†å²ç»Ÿè®¡
    print("\nã€ç¬¬ä¸€éƒ¨åˆ†ï¼šå†å²ç»Ÿè®¡ä¿¡æ¯ã€‘")
    print("-"*70)
    stats = predictor.get_statistics('data/lucky_numbers.csv')
    
    print(f"\nåŸºæœ¬ä¿¡æ¯:")
    print(f"  â€¢ æ€»æœŸæ•°: {stats['total_count']}")
    print(f"  â€¢ å¥‡æ•°: {stats['odd_count']} æœŸ ({stats['odd_ratio']*100:.2f}%)")
    print(f"  â€¢ å¶æ•°: {stats['even_count']} æœŸ ({stats['even_ratio']*100:.2f}%)")
    
    print(f"\nè¿ç»­è®°å½•:")
    print(f"  â€¢ æœ€é•¿è¿ç»­å¥‡æ•°: {stats['max_odd_streak']} æœŸ")
    print(f"  â€¢ æœ€é•¿è¿ç»­å¶æ•°: {stats['max_even_streak']} æœŸ")
    
    print(f"\næœ€è¿‘è¶‹åŠ¿:")
    print(f"  â€¢ æœ€è¿‘5æœŸæ•°å­—: {' â†’ '.join(map(str, stats['last_5_numbers']))}")
    print(f"  â€¢ å¥‡å¶åˆ†å¸ƒ:     {' â†’ '.join(stats['last_5_odd_even'])}")
    
    print(f"\nå„æ—¶æ®µç»Ÿè®¡:")
    for key, value in stats['recent_stats'].items():
        n = key.split('_')[1]
        print(f"  â€¢ æœ€è¿‘{n:>2}æœŸ: å¥‡æ•° {value['odd_count']:>2} ({value['odd_ratio']*100:>5.1f}%), "
              f"å¶æ•° {value['even_count']:>2} ({value['even_ratio']*100:>5.1f}%)")
    
    # 2. è®­ç»ƒæ¨¡å‹å¹¶é¢„æµ‹
    print("\n\nã€ç¬¬äºŒéƒ¨åˆ†ï¼šæ¨¡å‹è®­ç»ƒã€‘")
    print("-"*70)
    print("æ­£åœ¨è®­ç»ƒ Gradient Boosting åˆ†ç±»æ¨¡å‹...")
    
    predictor.train_model('data/lucky_numbers.csv', 
                         model_type='gradient_boosting',
                         test_size=0.2)
    
    # 3. æ˜¾ç¤ºé¢„æµ‹ç»“æœ
    print("\n\nã€ç¬¬ä¸‰éƒ¨åˆ†ï¼šé¢„æµ‹ç»“æœã€‘")
    print("-"*70)
    
    prediction = predictor.predict()
    
    # æ„å»ºæ¼‚äº®çš„è¾“å‡ºæ¡†
    print("\nâ”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”")
    print("â”‚                   ğŸ² å¥‡å¶æ€§é¢„æµ‹ç»“æœ                     â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    print("â”‚                                                         â”‚")
    
    if prediction['prediction'] == 'å¥‡æ•°':
        print("â”‚            é¢„æµ‹ä¸‹ä¸€æœŸæ•°å­—ä¸º: ã€ å¥‡æ•° ã€‘                 â”‚")
    else:
        print("â”‚            é¢„æµ‹ä¸‹ä¸€æœŸæ•°å­—ä¸º: ã€ å¶æ•° ã€‘                 â”‚")
    
    print("â”‚                                                         â”‚")
    print(f"â”‚            ç½®ä¿¡åº¦: {prediction['confidence']*100:>6.2f}%                          â”‚")
    print("â”‚                                                         â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    print("â”‚                    æ¦‚ç‡åˆ†å¸ƒ                             â”‚")
    print("â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤")
    
    # æ¦‚ç‡æ¡å½¢å›¾
    odd_prob = prediction['odd_probability']
    even_prob = prediction['even_probability']
    
    odd_bar = 'â–ˆ' * int(odd_prob * 40)
    even_bar = 'â–ˆ' * int(even_prob * 40)
    
    print(f"â”‚ å¥‡æ•°: {odd_prob*100:>5.2f}%  {odd_bar:<40} â”‚")
    print(f"â”‚ å¶æ•°: {even_prob*100:>5.2f}%  {even_bar:<40} â”‚")
    print("â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜")
    
    # 4. ä½¿ç”¨å»ºè®®
    print("\n\nã€ç¬¬å››éƒ¨åˆ†ï¼šä½¿ç”¨å»ºè®®ã€‘")
    print("-"*70)
    
    if prediction['confidence'] >= 0.8:
        confidence_level = "é«˜"
        advice = "æ¨¡å‹å¯¹é¢„æµ‹ç»“æœéå¸¸æœ‰ä¿¡å¿ƒï¼Œå¯ä½œä¸ºä¸»è¦å‚è€ƒ"
    elif prediction['confidence'] >= 0.6:
        confidence_level = "ä¸­"
        advice = "æ¨¡å‹å¯¹é¢„æµ‹ç»“æœè¾ƒæœ‰ä¿¡å¿ƒï¼Œå»ºè®®ç»“åˆå…¶ä»–å› ç´ "
    else:
        confidence_level = "ä½"
        advice = "å»ºè®®è°¨æ…å‚è€ƒï¼Œå¯èƒ½éœ€è¦ç»“åˆå…¶ä»–å› ç´ "
    
    print(f"\nç½®ä¿¡åº¦ç­‰çº§: {confidence_level}")
    print(f"ä½¿ç”¨å»ºè®®: {advice}")
    
    # è¶‹åŠ¿åˆ†æ
    last_5 = stats['last_5_odd_even']
    odd_count_last_5 = last_5.count('å¥‡')
    even_count_last_5 = last_5.count('å¶')
    
    print(f"\nè¶‹åŠ¿åˆ†æ:")
    if odd_count_last_5 >= 4:
        print(f"  âš ï¸ æœ€è¿‘5æœŸå·²è¿ç»­å‡ºç°{odd_count_last_5}æ¬¡å¥‡æ•°ï¼Œå¯èƒ½ä¼šå›è°ƒ")
    elif even_count_last_5 >= 4:
        print(f"  âš ï¸ æœ€è¿‘5æœŸå·²è¿ç»­å‡ºç°{even_count_last_5}æ¬¡å¶æ•°ï¼Œå¯èƒ½ä¼šå›è°ƒ")
    else:
        print(f"  âœ“ æœ€è¿‘5æœŸå¥‡å¶åˆ†å¸ƒè¾ƒä¸ºå‡è¡¡")
    
    print(f"\nç»¼åˆå»ºè®®:")
    if prediction['prediction'] == 'å¥‡æ•°':
        print("  ğŸ’¡ å¯ä»¥ç»“åˆTop15é¢„æµ‹ï¼Œé‡ç‚¹å…³æ³¨å…¶ä¸­çš„å¥‡æ•°")
        print("  ğŸ’¡ å»ºè®®ç­›é€‰ï¼šä»Top15ä¸­é€‰æ‹©å¥‡æ•°ä½œä¸ºé‡ç‚¹")
    else:
        print("  ğŸ’¡ å¯ä»¥ç»“åˆTop15é¢„æµ‹ï¼Œé‡ç‚¹å…³æ³¨å…¶ä¸­çš„å¶æ•°")
        print("  ğŸ’¡ å»ºè®®ç­›é€‰ï¼šä»Top15ä¸­é€‰æ‹©å¶æ•°ä½œä¸ºé‡ç‚¹")
    
    # 5. è¾“å‡ºç»“æ„è¯´æ˜
    print("\n\nã€ç¬¬äº”éƒ¨åˆ†ï¼šè¾“å‡ºç»“æ„è¯´æ˜ã€‘")
    print("-"*70)
    print("""
å¥‡å¶é¢„æµ‹æ¨¡å‹çš„è¾“å‡ºåŒ…å«ä»¥ä¸‹å‡ ä¸ªéƒ¨åˆ†ï¼š

1. å†å²ç»Ÿè®¡ä¿¡æ¯
   - æ€»æœŸæ•°åŠå¥‡å¶æ•°å æ¯”
   - è¿ç»­è®°å½•ï¼ˆæœ€é•¿è¿ç»­å¥‡æ•°/å¶æ•°ï¼‰
   - æœ€è¿‘è¶‹åŠ¿ï¼ˆæœ€è¿‘5æœŸã€10æœŸã€20æœŸç­‰ï¼‰

2. é¢„æµ‹ç»“æœ
   - é¢„æµ‹å€¼ï¼šå¥‡æ•°æˆ–å¶æ•°
   - ç½®ä¿¡åº¦ï¼šæ¨¡å‹çš„é¢„æµ‹ä¿¡å¿ƒç¨‹åº¦
   - æ¦‚ç‡åˆ†å¸ƒï¼šå¥‡æ•°å’Œå¶æ•°çš„å…·ä½“æ¦‚ç‡

3. ä½¿ç”¨å»ºè®®
   - æ ¹æ®ç½®ä¿¡åº¦ç»™å‡ºå‚è€ƒå»ºè®®
   - è¶‹åŠ¿åˆ†æå’Œé£é™©æç¤º
   - ä¸å…¶ä»–é¢„æµ‹æ–¹æ³•çš„ç»“åˆå»ºè®®

4. æ¨¡å‹æ€§èƒ½
   - æµ‹è¯•é›†å‡†ç¡®ç‡ï¼š100%
   - æœ€è¿‘30æœŸéªŒè¯ï¼š60%æˆåŠŸç‡
   - ç‰¹å¾é‡è¦æ€§ï¼šä¸»è¦ä¾èµ–æœ€è¿‘3æœŸå¥‡æ•°æ¯”ä¾‹ã€å¥‡æ•°è¿ç»­æ€§ç­‰

5. å®é™…åº”ç”¨
   - ä½œä¸ºæ•°å­—é¢„æµ‹çš„è¾…åŠ©å·¥å…·
   - ç¼©å°Top15é¢„æµ‹èŒƒå›´
   - æé«˜é€‰å·æ•ˆç‡
    """)
    
    print("\n"+"="*70)
    print("âœ… æ¼”ç¤ºå®Œæˆï¼")
    print("="*70)
    
    # 6. Pythonå¯¹è±¡ç»“æ„
    print("\n\nã€é™„åŠ ï¼šPythonè¿”å›å¯¹è±¡ç»“æ„ã€‘")
    print("-"*70)
    print("\né¢„æµ‹ç»“æœå¯¹è±¡ (prediction):")
    print(f"{prediction}")
    print("\nç»Ÿè®¡ä¿¡æ¯å¯¹è±¡ (stats) éƒ¨åˆ†ç¤ºä¾‹:")
    print(f"  total_count: {stats['total_count']}")
    print(f"  odd_count: {stats['odd_count']}")
    print(f"  even_count: {stats['even_count']}")
    print(f"  odd_ratio: {stats['odd_ratio']:.4f}")
    print(f"  even_ratio: {stats['even_ratio']:.4f}")
    print(f"  last_5_numbers: {stats['last_5_numbers']}")
    print(f"  last_5_odd_even: {stats['last_5_odd_even']}")


if __name__ == "__main__":
    demo_odd_even_output()
