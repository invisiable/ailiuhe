# 幸运数字预测系统使用指南

## 系统简介

本系统是一个基于机器学习的幸运数字预测工具，通过学习历史幸运数字数据（包括数字、生肖、五行元素）来预测未来的幸运数字。

## 数据格式

训练数据需要包含以下4个字段：

- **date**: 日期（格式：YYYY-MM-DD）
- **number**: 幸运数字（1-49）
- **animal**: 生肖（鼠、牛、虎、兔、龙、蛇、马、羊、猴、鸡、狗、猪）
- **element**: 五行（金、木、水、火、土）

示例数据：
```
date,number,animal,element
2024-01-01,24,鼠,金
2024-01-02,29,牛,木
2024-01-03,30,虎,水
```

## 快速开始

### 1. 生成示例数据

```powershell
python generate_data.py
```

这将生成300条历史数据到 `data/lucky_numbers.csv`

### 2. 测试预测功能

```powershell
python test_predictor.py
```

这将：
- 加载训练数据
- 训练预测模型
- 预测未来5期幸运数字
- 显示特征重要性
- 保存训练好的模型

### 3. 启动图形界面

```powershell
python main.py
```

## 使用流程

### 方式一：命令行测试（快速验证）

直接运行 `test_predictor.py` 即可看到预测结果。

### 方式二：图形界面（推荐）

1. **加载数据**
   - 点击"浏览"选择 `data/lucky_numbers.csv`
   - 在"目标列"选择 `number`
   - 点击"加载数据"

2. **选择模型**
   - 随机森林（推荐，精度较高）
   - 梯度提升（速度较快）
   - 神经网络（适合大数据集）

3. **开始训练**
   - 设置测试集比例（默认0.2）
   - 点击"开始训练"
   - 查看训练日志和评估指标

4. **查看结果**
   - 训练日志标签页：详细的训练过程
   - 可视化标签页：特征重要性图表

5. **预测未来**
   - 训练完成后，点击"预测下一期"
   - 系统会显示：幸运数字、生肖、五行

6. **保存模型**
   - 点击"保存模型"
   - 模型保存在 `models/` 目录

## 预测原理

系统使用时间序列预测方法：

1. **特征工程**：
   - 使用过去10期的历史数字
   - 计算统计特征（均值、标准差、最大值、最小值、趋势）
   - 编码生肖和五行信息

2. **模型训练**：
   - 随机森林回归器（默认200棵树）
   - 标准化特征
   - 时间序列分割（按顺序分割训练集和测试集）

3. **预测输出**：
   - 幸运数字：基于模型预测
   - 生肖：按12生肖周期循环
   - 五行：按5行周期循环

## 评估指标

- **MAE** (平均绝对误差)：预测值与真实值的平均差距，越小越好
- **RMSE** (均方根误差)：对大误差更敏感，越小越好
- **R²** (决定系数)：模型拟合程度，越接近1越好

## 文件说明

- `generate_data.py` - 生成示例训练数据
- `lucky_number_predictor.py` - 预测核心模块
- `test_predictor.py` - 命令行测试脚本
- `main.py` - 图形界面主程序
- `data/lucky_numbers.csv` - 训练数据
- `models/` - 保存的模型文件

## 常见问题

**Q: 预测准确率如何提高？**
A: 
- 增加历史数据量（建议至少500条）
- 使用更长的序列长度
- 尝试不同的模型类型
- 添加更多特征

**Q: 可以预测多期吗？**
A: 可以，修改 `n_predictions` 参数即可预测多期，但预测期数越远，不确定性越大。

**Q: 如何使用自己的数据？**
A: 准备CSV文件，确保包含 date, number, animal, element 四列，然后在界面中加载即可。

## 技术栈

- Python 3.8+
- scikit-learn：机器学习算法
- pandas：数据处理
- numpy：数值计算
- matplotlib：数据可视化
- tkinter：图形界面

## 注意事项

⚠️ 本系统仅供娱乐和学习使用，预测结果不构成任何投资建议。幸运数字具有随机性，历史数据不能保证未来结果。

## 🎲 系统概述

这是一个基于机器学习的幸运数字预测系统，通过学习历史幸运数字数据的规律，预测未来可能出现的幸运数字。

## 📊 数据准备

### 数据格式要求

CSV文件格式，至少包含以下列：
- **number列**：历史幸运数字（必需）
- **date列**：日期（可选，用于按时间排序）

### 示例数据

项目包含示例数据：`data/lucky_numbers.csv`
```csv
date,number
2024-01-01,7
2024-01-02,15
2024-01-03,23
...
```

### 数据量建议

- **最少**：30个历史数据点
- **推荐**：100+个历史数据点
- **最佳**：500+个历史数据点（数据越多，模型越准确）

## 🚀 使用步骤

### 1. 加载历史数据

1. 点击"浏览..."按钮选择CSV文件
2. 确认"数字列"名称（如：number）
3. 可选择"日期列"（如：date）
4. 点击"加载数据"按钮

系统会显示：
- 历史数据点数量
- 训练样本数量
- 最近10个历史数字

### 2. 配置训练参数

**预测模型选择：**
- **随机森林（推荐）**：准确度高，训练速度快
- **梯度提升**：预测精度高，但训练较慢
- **神经网络**：适合大数据集，需要更多样本

**测试集比例：**
- 默认0.2（20%数据用于测试）
- 范围：0.1-0.3

**历史窗口：**
- 默认10（使用过去10个数字预测下一个）
- 建议：5-20之间

### 3. 训练模型

1. 点击"🚀 开始训练"按钮
2. 等待训练完成（通常几秒到几分钟）
3. 查看训练日志和性能指标

**性能指标说明：**
- **MAE（平均绝对误差）**：越小越好，表示平均预测偏差
- **RMSE（均方根误差）**：越小越好，对大误差更敏感
- **R²分数**：越接近1越好，表示模型拟合度

### 4. 查看可视化结果

**预测效果标签页：**
- 上图：实际值vs预测值对比
- 下图：预测误差分布

**特征重要性标签页：**
- 显示哪些历史信息对预测最重要
- lag_1表示最近一个数字
- mean/std等是统计特征

### 5. 预测幸运数字

1. 设置"预测未来"数量（1-20个）
2. 点击"🔮 开始预测"按钮
3. 在"预测结果"区域查看预测的幸运数字

### 6. 保存/加载模型

**保存模型：**
- 点击"💾 保存模型"
- 模型自动保存到`models/`目录
- 文件名包含时间戳

**加载模型：**
- 点击"📂 加载模型"
- 选择之前保存的.joblib文件
- 加载后可直接预测，无需重新训练

## 🎯 模型选择建议

### 数据量较小（<100个）
- 使用：随机森林
- 历史窗口：5-10
- 测试集比例：0.15

### 数据量中等（100-500个）
- 使用：随机森林或梯度提升
- 历史窗口：10-15
- 测试集比例：0.2

### 数据量较大（>500个）
- 使用：梯度提升或神经网络
- 历史窗口：15-20
- 测试集比例：0.2-0.3

## 📈 提高预测准确度的技巧

1. **收集更多历史数据**
   - 数据量是影响预测准确度的最关键因素

2. **选择合适的历史窗口**
   - 如果数字有周期性规律，调整窗口大小匹配周期

3. **尝试不同模型**
   - 对比不同模型的性能指标
   - 选择测试集表现最好的

4. **多次训练取平均**
   - 对关键预测，可以多次训练取预测结果的平均值

5. **关注数据质量**
   - 确保历史数据准确无误
   - 按时间顺序排列

## ⚠️ 注意事项

1. **预测的局限性**
   - 机器学习只能识别历史数据中的模式
   - 如果数字完全随机，预测准确度会受限
   - 预测结果仅供参考

2. **模型训练**
   - 数据量越大，训练时间越长
   - 神经网络模型训练最慢
   - 首次训练建议使用随机森林

3. **数据隐私**
   - 所有数据和模型都在本地处理
   - 不会上传到任何服务器

## 🔧 常见问题

**Q: 为什么我的预测不准确？**
A: 可能原因：
- 历史数据量太少
- 数字规律性不强
- 历史窗口设置不合适
- 需要尝试其他模型

**Q: 训练很慢怎么办？**
A: 
- 减少测试集比例
- 使用随机森林而非神经网络
- 减少历史窗口大小

**Q: 可以预测多种类型的数字吗？**
A: 
- 可以，只要有足够的历史数据
- 适用于彩票号码、股票价格等任何数字序列

**Q: 模型需要多久更新一次？**
A: 
- 当有新的历史数据时，建议重新训练
- 一般每周或每月更新一次

## 📝 快速开始示例

1. 运行程序：`python main.py`
2. 加载示例数据：选择`data/lucky_numbers.csv`
3. 数字列：`number`，日期列：`date`
4. 点击"加载数据"
5. 保持默认配置（随机森林，0.2测试集，窗口10）
6. 点击"开始训练"
7. 训练完成后，预测5个数字
8. 查看预测结果！

## 🎓 技术原理

系统使用时间序列预测方法：
1. 将历史序列转换为监督学习问题
2. 提取特征：历史值、均值、标准差、趋势等
3. 使用集成学习或深度学习模型
4. 滚动预测未来数字

祝您好运！🍀
