# 奇偶性预测模型使用说明

## 📋 概述

新增了一个专门预测幸运数字奇偶性的机器学习模型，可以预测下一期数字是**奇数**还是**偶数**。

## 🎯 模型性能

### 验证结果（最近30期）

- **总体准确率**: 60.00% (18/30)
- **奇数预测准确率**: 57.14% (8/14)
- **偶数预测准确率**: 62.50% (10/16)

### 测试集性能

- **训练集准确率**: 100%
- **测试集准确率**: 100%
- **使用模型**: Gradient Boosting Classifier

## 📁 相关文件

### 核心文件

| 文件名 | 说明 |
|--------|------|
| `odd_even_predictor.py` | 奇偶性预测模型核心代码 |
| `quick_predict_odd_even.py` | 快速预测使用示例 |
| `validate_odd_even.py` | 模型验证脚本 |

### 生成文件

| 文件名 | 说明 |
|--------|------|
| `奇偶预测验证报告_30期.md` | 最近30期验证报告 |
| `odd_even_validation_30periods.csv` | 详细验证结果数据 |
| `models/OddEven_gradient_boosting_*.joblib` | 保存的模型文件 |

## 🚀 快速使用

### 方法1: 快速预测（推荐）

```bash
python quick_predict_odd_even.py
```

这个脚本会：
1. 显示历史奇偶统计信息
2. 训练模型
3. 预测下一期的奇偶性
4. 提供置信度和建议

### 方法2: 使用Python代码

```python
from odd_even_predictor import OddEvenPredictor

# 创建预测器
predictor = OddEvenPredictor()

# 训练模型
predictor.train_model('data/lucky_numbers.csv', 
                     model_type='gradient_boosting')

# 预测下一期
prediction = predictor.predict()

print(f"预测结果: {prediction['prediction']}")
print(f"置信度: {prediction['confidence']*100:.2f}%")
print(f"奇数概率: {prediction['odd_probability']*100:.2f}%")
print(f"偶数概率: {prediction['even_probability']*100:.2f}%")
```

### 方法3: 获取历史统计

```python
from odd_even_predictor import OddEvenPredictor

predictor = OddEvenPredictor()
stats = predictor.get_statistics('data/lucky_numbers.csv')

print(f"总期数: {stats['total_count']}")
print(f"奇数占比: {stats['odd_ratio']*100:.2f}%")
print(f"偶数占比: {stats['even_ratio']*100:.2f}%")
print(f"最近5期: {stats['last_5_numbers']}")
```

## 🔍 模型特征

模型使用了28个特征，主要包括：

### 1. 历史奇偶特征
- 前1-10期的奇偶性
- 最近3/5/7/10期的奇数比例
- 奇数连续次数

### 2. 生肖和五行特征
- 生肖编码（12个生肖）
- 五行编码（金木水火土）
- 前1-3期的生肖和五行

### 3. 数字特征
- 数字区间（1-10, 11-20, 21-30, 31-40, 41-49）
- 模运算（mod 3, mod 5, mod 7）
- 周期性特征

### 4. 关键特征（重要性排名）
1. **odd_ratio_3**: 最近3期奇数比例（重要性: 48%）
2. **odd_streak**: 奇数连续次数（重要性: 23%）
3. **prev_1_odd**: 前一期奇偶性（重要性: 15%）
4. **animal_code**: 生肖编码（重要性: 8%）

## 📊 历史统计

### 总体分布（全部315期）
- **奇数**: 152期 (48.25%)
- **偶数**: 163期 (51.75%)

### 连续记录
- **最长连续奇数**: 6期
- **最长连续偶数**: 8期

### 最近趋势
- **最近10期**: 奇数30%, 偶数70%
- **最近20期**: 奇数30%, 偶数70%
- **最近30期**: 奇数46.7%, 偶数53.3%
- **最近50期**: 奇数42%, 偶数58%

## 🎯 使用建议

### 1. 置信度解读

| 置信度 | 建议 |
|--------|------|
| ≥ 80% | 高置信度，可作为主要参考 |
| 60-80% | 中等置信度，建议结合其他因素 |
| < 60% | 低置信度，谨慎参考 |

### 2. 趋势分析
- 如果最近5期有4次或以上是奇数/偶数，可能会出现回调
- 结合历史统计，整体偶数略多（51.75%）

### 3. 综合使用
- 可以结合数字预测模型（预测具体数字）
- 可以作为筛选条件，缩小预测范围
- 例如：如果预测为偶数，只关注Top20中的偶数

## 🔧 验证和测试

### 运行验证脚本
```bash
python validate_odd_even.py
```

这会对最近30期进行滚动预测验证，生成详细报告。

### 支持的模型类型
- `random_forest`: 随机森林（准确率: 90%）
- `gradient_boosting`: 梯度提升（准确率: 100%，推荐）
- `logistic`: 逻辑回归（准确率: 100%）
- `xgboost`: XGBoost（准确率: 100%）
- `lightgbm`: LightGBM（准确率: 100%）

## 📈 性能对比

| 模型 | 训练集准确率 | 测试集准确率 | 最近30期验证 |
|------|-------------|-------------|-------------|
| Random Forest | 100% | 90.16% | - |
| Gradient Boosting | 100% | 100% | 60% |
| Logistic Regression | 100% | 100% | - |
| XGBoost | 100% | 100% | - |
| LightGBM | 100% | 100% | - |

## 💡 实际应用示例

### 场景1: 快速查看预测
```bash
python quick_predict_odd_even.py
```

输出示例：
```
预测下一期数字为: 【偶数】
置信度: 100.00%
奇数概率: 0.00%
偶数概率: 100.00%
```

### 场景2: 结合数字预测
如果数字预测给出Top20，奇偶预测为"偶数"，则只关注：
```
Top20中的偶数: [22, 18, 12, 10, 20, 24, 16, 4, ...]
```

### 场景3: 趋势分析
查看最近5期：
```
最近5期: 27(奇) -> 24(偶) -> 3(奇) -> 13(奇) -> 16(偶)
```
奇偶分布较均衡，可以放心参考模型预测。

## ⚠️ 注意事项

1. **历史数据依赖**: 模型基于历史数据训练，需要足够的历史数据
2. **不保证100%准确**: 这是辅助工具，不能保证每次都准确
3. **持续验证**: 建议定期验证模型准确率，必要时重新训练
4. **综合判断**: 建议结合其他预测方法和个人经验

## 🔄 更新和维护

### 重新训练模型
当有新数据时，可以重新训练：
```python
predictor = OddEvenPredictor()
predictor.train_model('data/lucky_numbers.csv')
predictor.save_model()
```

### 使用保存的模型
```python
predictor = OddEvenPredictor()
predictor.load_model('models/OddEven_gradient_boosting_20251215_092859.joblib')
prediction = predictor.predict('data/lucky_numbers.csv')
```

## 📞 技术支持

如有问题，请查看：
- 验证报告: `奇偶预测验证报告_30期.md`
- 详细结果: `odd_even_validation_30periods.csv`
- 源代码: `odd_even_predictor.py`

---

**更新时间**: 2025-12-15  
**模型版本**: v1.0  
**最近验证准确率**: 60%
