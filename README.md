# 幸运数字预测系统 🎲

一个基于机器学习的幸运数字预测应用程序，通过学习历史幸运数字数据来预测未来的幸运数字。提供友好的图形界面进行数据输入、模型训练和预测。

## 核心功能 ✨

- 🎯 **智能预测**: 基于历史数据预测未来幸运数字
- 📊 **多种模型**: 支持随机森林、梯度提升、神经网络
- 📈 **实时可视化**: 预测效果对比图、特征重要性分析
- 💾 **模型管理**: 保存和加载训练好的模型
- 🔮 **批量预测**: 一次预测多个未来数字
- 📉 **性能评估**: MAE、RMSE、R²等多项指标

## 系统特点

### 时间序列预测
- 使用过去N个数字预测下一个（可配置窗口大小）
- 自动提取统计特征（均值、标准差、趋势等）
- 支持日期排序，确保时序正确

### 三种预测模型
1. **随机森林**（推荐）- 准确度高，训练快速
2. **梯度提升** - 精度更高，适合复杂模式
3. **神经网络** - 适合大数据集，深度学习

## 项目结构

```
AIagent/
├── main.py                      # 主程序入口
├── lucky_number_gui.py          # 幸运数字预测界面
├── lucky_number_predictor.py    # 预测核心模块
├── gui.py                       # 通用模型训练界面（备用）
├── model_trainer.py             # 通用模型训练模块（备用）
├── requirements.txt             # 项目依赖
├── .gitignore                   # Git忽略文件
├── 使用指南.md                  # 详细使用说明
├── data/                        # 数据目录
│   ├── lucky_numbers.csv        # 示例幸运数字数据
│   └── sample.csv               # 通用示例数据
├── models/                      # 模型保存目录（自动创建）
└── README.md                    # 项目说明文档
```

## 快速开始 🚀

### 1. 安装依赖

```powershell
pip install -r requirements.txt
```

### 2. 启动程序

```powershell
python main.py
```

### 3. 使用示例数据

程序启动后：
1. 点击"浏览..."，选择 `data/lucky_numbers.csv`
2. 数字列选择：`number`
3. 日期列选择：`date`
4. 点击"加载数据"
5. 保持默认配置，点击"🚀 开始训练"
6. 训练完成后，设置预测数量，点击"🔮 开始预测"
7. 查看预测的幸运数字！

## 使用说明 📖

### 数据准备

创建CSV文件，格式如下：

```csv
date,number
2024-01-01,7
2024-01-02,15
2024-01-03,23
...
```

**要求：**
- 必须包含数字列（列名可自定义）
- 建议包含日期列用于排序
- 至少30个历史数据点（越多越好）

### 界面功能

#### 1️⃣ 历史幸运数字数据
- 加载CSV数据文件
- 选择数字列和日期列
- 显示数据统计信息

#### 2️⃣ 模型训练配置
- **预测模型**：选择随机森林/梯度提升/神经网络
- **测试集比例**：0.1-0.3（默认0.2）
- **历史窗口**：使用过去多少个数字预测（默认10）

#### 3️⃣ 训练结果与可视化
- **训练日志**：详细的训练过程和性能指标
- **预测效果**：实际值vs预测值对比图
- **特征重要性**：哪些信息对预测最重要

#### 4️⃣ 幸运数字预测
- 设置预测未来的数量（1-20个）
- 一键预测，显示结果
- 基于最新历史数据滚动预测

### 性能指标说明

- **MAE（平均绝对误差）**：预测值与实际值的平均差距，越小越好
- **RMSE（均方根误差）**：对大误差更敏感的误差度量，越小越好
- **R²分数**：模型拟合优度，范围0-1，越接近1越好

## 模型选择建议 🎯

| 数据量 | 推荐模型 | 历史窗口 | 测试集 |
|--------|----------|----------|--------|
| < 100个 | 随机森林 | 5-10 | 0.15 |
| 100-500个 | 随机森林/梯度提升 | 10-15 | 0.2 |
| > 500个 | 梯度提升/神经网络 | 15-20 | 0.2-0.3 |

## 技术原理 🔬

### 时间序列转监督学习

将序列 `[1, 2, 3, 4, 5]` 转换为：
```
特征 → 目标
[1, 2, 3] → 4
[2, 3, 4] → 5
```

### 特征工程

对每个窗口提取：
- 历史值（lag_1, lag_2, ...）
- 统计特征（均值、标准差、最大值、最小值）
- 趋势特征（最近变化）

### 模型集成

使用多个决策树或神经网络层，综合多个弱学习器的预测结果。

## 依赖包

```
numpy>=1.21.0          # 数值计算
pandas>=1.3.0          # 数据处理  
scikit-learn>=1.0.0    # 机器学习算法
matplotlib>=3.3.0      # 数据可视化
joblib>=1.0.0          # 模型序列化
```

Python版本要求：3.8+

## 常见问题 ❓

**Q: 预测不准确怎么办？**
- 增加历史数据量
- 尝试不同的模型
- 调整历史窗口大小
- 检查数据是否有规律性

**Q: 训练速度慢？**
- 使用随机森林而非神经网络
- 减少历史窗口大小
- 降低测试集比例

**Q: 可以预测其他类型的数字吗？**
- 可以！适用于任何数字序列
- 股票价格、彩票号码、温度等
- 只要有足够的历史数据

**Q: 需要多少历史数据？**
- 最少：30个
- 推荐：100+个
- 最佳：500+个

## 注意事项 ⚠️

1. **预测仅供参考**
   - 机器学习基于历史模式
   - 完全随机的数字难以预测
   - 不保证100%准确

2. **数据质量重要**
   - 确保数据准确无误
   - 按时间顺序排列
   - 无缺失值

3. **本地运行**
   - 所有数据在本地处理
   - 不上传任何信息
   - 隐私安全

## 后续扩展 🔮

可能的功能扩展：
- [ ] 支持多变量输入（考虑更多影响因素）
- [ ] LSTM/GRU深度学习模型
- [ ] 自动超参数优化
- [ ] 集成多个模型的预测结果
- [ ] 置信区间估计
- [ ] Web界面版本
- [ ] 实时数据更新

## 技术栈 🛠️

- **Python 3.8+** - 主要编程语言
- **Tkinter** - 图形界面
- **scikit-learn** - 机器学习
- **pandas** - 数据处理
- **matplotlib** - 数据可视化
- **numpy** - 数值计算

## 贡献 🤝

欢迎提出建议和改进！

## 许可证 📄

本项目仅供学习和研究使用。

---

**祝您好运！🍀**

如需详细使用说明，请查看 [使用指南.md](使用指南.md)
